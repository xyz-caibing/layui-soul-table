<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>layui-soul-table</title>
    <meta name="keywords" content="layui,table,表头筛选,tablefilter,tableChild,子表,表格筛选"/>
    <meta name="description" content="layui表头筛选,tablefilter,tableChild,子表,表格筛选"/>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="layui/css/layui.css" media="all"/>
    <link rel="stylesheet" href="soulTable.css" media="all"/>
</head>
<body>
<div class="layui-row">
    <div class="layui-col-lg3 layui-col-md4 layui-col-sm6">
        <div class="layui-inline">
            <label class="layui-form-label">诗词</label>
            <div class="layui-input-inline" >
                <input type="text" name="title"
                       class="layui-input" placeholder="请输入诗词关键字1">
            </div>
        </div>
    </div>
    <div class="layui-col-lg3 layui-col-md4 layui-col-sm6">
        <div class="layui-inline">
            <label class="layui-form-label">内容</label>
            <div class="layui-input-inline">
                <input type="text" name="content"
                       class="layui-input" placeholder="请选择内容关键词">
            </div>
        </div>
    </div>
    <div class="layui-col-lg1 layui-col-md1 layui-col-sm2 layui-col-xs3">
        <button class="layui-btn mgl-20" lay-submit="" lay-filter="search"><i class="layui-icon">&#xe615;</i>查询</button>
    </div>
    <div class="layui-col-lg1 layui-col-md1 layui-col-sm2 layui-col-xs3">
        <button class="layui-btn mgl-20" lay-submit="" lay-filter="export"><i class="layui-icon">&#xe615;</i>导出</button>
    </div>
</div>
<table id="myTable" ></table>
<script type="text/html" id="author">
{{ d.author }} + 1
</script>
<script type="text/html" id="bar">
    <a type="button" class="" lay-event="show">查看</a>
    <a type="button" class="" lay-event="edit">编辑</a>
</script>
<script type="text/javascript" src="layui/layui.js"></script>
<script>
    // 自定义模块
    layui.config({
        base: 'ext/',   // 模块目录
        version: 'v1.6.3'
    }).extend({                         // 模块别名
        soulTable: 'soulTable.slim'
    });

    layui.use(['form', 'table','soulTable'], function () {
        var table = layui.table,
            soulTable = layui.soulTable,
            $ = layui.$,
            form = layui.form;

        var myTable = table.render({
            elem: '#myTable'
            , defaultToolbar: ['filter']
            ,height: $(document).height() - $('#myTable').offset().top - 20
            ,page: {
                count: 1000000 //数据总数，从服务端得到
                , prev: '<i class="layui-icon"></i>'
                , groups: 3
                , curr: 1
                , next: '<i class="layui-icon"></i>'
                , limit: 10000
                , limits: [20, 50, 100, 1000, 10000]
                , layout: ['prev', 'page', 'next', 'skip', 'count', 'limit']
            }
            ,cols: getCols()
            ,done: function () {
                soulTable.render(this)
            }
            , operandFlexBar: {status: 'show', unfoldMoreSerach: {minHeight: 'full-205', maxHeight: 'full-295'}}
        });
        search({});
        function search(data) {
            var loading = layer.load(2);
            $.ajax({
                url: 'data.json',
                data: data,
                dataType: 'json',
                success: function (res) {
                    // myTable.reload({
                    //     data: res.data
                    // })
                    table.reload('myTable', {
                        data: res.data
                    })
                },
                complete: function () {
                    layer.close(loading)
                }
            })
        }
        form.on('submit(search)', function (data) {
            search(data.field);
        })
        form.on('submit(export)', function () {
            soulTable.export(myTable);
        })

        function getCols() {
            return [[ //表头
                {title:'NO.', type:'numbers', totalRowText: '合计'}
                , {field: 'data_source', title: '类型', width: '200', align: 'center'}
                , {field: 'status', title: '推送共享状态', width: '200', align: 'center'}
                , {field: 'data_type', title: '数据类型', width: '200', align: 'center'}
                , {field: 'id', title: '订单流水号', width: '300', align: 'center'}
                , {field: 'connect_id', title: '关联订单流水号', width: '200', align: 'center'}
                , {field: 'business_num', title: '业务单号', width: '200', align: 'center'}
                , {field: 'company_code', title: '公司编码', width: '200', align: 'center'}
                , {field: 'company_name', title: '公司名称', width: '200', align: 'center'}
                , {field: 'contact_company_code', title: '往来公司编码', width: '200', align: 'center'}
                , {field: 'customer_code', hide: true, title: '往来客户代码', width: '200', align: 'center'}
                , {field: 'contact_company_name', title: '往来公司名称', width: '200', align: 'center'}
                , {field: 'external_customer_code', hide: true, title: '外部客户代码', width: '200', align: 'center'}
                , {field: 'fee_code', title: '费用大类', width: '200', align: 'center'}
                , {field: 'sub_fee_code', title: '费用小类', width: '250', align: 'center'}
                , {field: 'currency_code', hide: true, title: '币种', width: '250', align: 'center'}
                , {field: 'original_amount', hide: true, title: '原始金额', width: '250', totalCol:true, align: 'right', style:'text-align:right', templet: function(d){
                        return d.original_amount;
                    }}
                , {field: 'amount', hide: true, title: '金额', width: '250', totalCol:true, align: 'right', style:'text-align:right', templet: function(d){
                        return d.amount;
                    }}
                , {field: 'settle_exchange_rate', hide: true, title: '结算汇率', width: '250', align: 'center'}
                , {field: 'settle_amount', title: '结算金额', width: '200', totalCol:true, align: 'right', style:'text-align:right', templet: function(d){
                        return d.settle_amount;
                    }}
                , {field: 'settle_amount_compute', title: '结算金额（计算值）', width: '220', totalCol:true, align: 'right', style:'text-align:right', templet: function(d){
                        return d.settle_amount_compute;
                    }}
                , {field: 'settle_amount_last', title: '进位差异', width: '220', totalCol:true, align: 'right', style:'text-align:right', templet: function(d){
                        return d.settle_amount_last;
                    }}
                , {field: 'settle_currency_code',  title: '结算币种', width: '200', align: 'center'}
                , {field: 'product_line', hide: true,  title: '产品线', width: '200', align: 'center'}
                , {field: 'flow_type', hide: true,  title: '流水类型', width: '200', align: 'center'}
                , {field: 'fee_time', hide: true,  title: '费用发生时间', width: '200', align: 'center'}
                , {field: 'billing_date',  title: '账务日期', width: '200', align: 'center'}
                , {field: 'volume', hide: true,  title: '体积', width: '200', align: 'center'}
                , {field: 'volume_unit', hide: true,  title: '体积单位', width: '200', align: 'center'}
                , {field: 'track_number', hide: true,  title: '跟踪号', width: '200', align: 'center'}
                , {field: 'cabinet_number', hide: true,  title: '柜号', width: '200', align: 'center'}
                , {field: 'size_length', hide: true,  title: '收入长', width: '200', align: 'center'}
                , {field: 'size_width', hide: true,  title: '收入宽', width: '200', align: 'center'}
                , {field: 'size_height', hide: true,  title: '收入高', width: '200', align: 'center'}
                , {field: 'weight', hide: true,  title: '收入重量', width: '200', align: 'center'}
                , {field: 'order_type', hide: true,  title: '订单类型', width: '200', align: 'center'}
                , {field: 'logistics_product_code', hide: true,  title: '物流产品编码', width: '200', align: 'center'}
                , {field: 'warehouse_code', hide: true,  title: '物理仓编码', width: '180', align: 'center'}
                , {field: 'warehouse_name', hide: true,  title: '物理仓名称', width: '180', align: 'center'}
                , {field: 'warehouse_area_code', hide: true,  title: '区域仓编码', width: '180', align: 'center'}
                , {field: 'warehouse_area_name', hide: true,  title: '区域仓名称', width: '180', align: 'center'}
                , {field: 'postal_code', hide: true,  title: '邮编', width: '200', align: 'center'}
                , {field: 'postal_area', hide: true,  title: '邮编区域', width: '200', align: 'center'}
                , {field: 'pack_num', hide: true,  title: '包裹数量', width: '200', align: 'center'}
                , {field: 'postal_city', hide: true,  title: '递送州', width: '200', align: 'center'}
                , {field: 'transport_mode', hide: true,  title: '运输方式', width: '200', align: 'center'}
                , {field: 'rate', hide: true,  title: '固定比例', width: '200', align: 'center'}
                , {field: 'cost', hide: true,  title: '成本', width: '200', totalCol:true, align: 'right', style:'text-align:right', templet: function(d){
                        if(d.cost == null) {
                            return '';
                        }
                        return d.cost;
                    }}
                , {field: 'volume_rate', hide: true,  title: '体积占比', width: '200', align: 'center'}
                , {field: 'acreage', hide: true,  title: '面积', width: '200', align: 'center'}
                , {field: 'acreage_unit_price', hide: true,  title: '面积单价', width: '200', align: 'center'}
                , {field: 'order_count', hide: true,  title: '订单数量', width: '200', align: 'center'}
                , {field: 'order_unit_price', hide: true,  title: '订单单价', width: '200', align: 'center'}
                // , {field: 'batch_number', hide: true, title: '批次号', width: '200', align: 'center'}
                , {field: 'offset_status', hide: true, title: '是否冲销', width: '200', align: 'center'}
                , {field: 'pricing_rules_code', hide: true, title: '定价规则编码', width: '200', align: 'center'}
                , {field: 'create_time', title: '创建时间', width: '200', align: 'center'}
            ]];
        }
    })
</script>
</body>
</html>
